# one line scraper
import scrapy, json, csv,pandas as pd; data = DataFrame();open('courses.csv', 'w').write('code,title,descripton\n'); (fetch(scrapy.Request(url='https://classes.oregonstate.edu/api/?page=fose&route=search&subject=CS', method='POST', body='%7B%22other%22%3A%7B%22srcdb%22%3A%22202101%22%7D%2C%22criteria%22%3A%5B%7B%22field%22%3A%22subject%22%2C%22value%22%3A%22CS%22%7D%5D%7D')), [(fetch(scrapy.Request(url='https://classes.oregonstate.edu/api/?page=fose&route=details', meta={'code': course['code'], 'title': course['title']}, method='POST', body=json.dumps({'group': 'code:' + course['code']}))), csv.DictWriter(open('courses.csv', 'a'), ['code', 'title', 'description']).writerow({'code': response.meta.get('code'), 'title': response.meta.get('title'), 'description': json.loads(response.text)['description']})) for course in json.loads(response.text)['results']]);pd.read_csv('courses.csv').sort_values('code');data.drop_duplicates(inplace=True);data.to_csv('khi.csv',index=False);
